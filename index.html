<!DOCTYPE html>
<html lang="ne">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nepali Calendar - Bikram Sambat Calendar by Om Pandey</title>
    <meta name="description" content="Nepali Patrika - Bikram Sambat Calendar with Tithi, Events and Festivals">
    <meta name="author" content="Om Pandey">
    
    <link rel="shortcut icon" href="MainLogo.png" type="image/x-icon">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#6366f1">
    <link rel="apple-touch-icon" href="MainLogo.png">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&family=Noto+Sans+Devanagari:wght@400;500;600;700;800;900&family=Poppins:wght@600;700;800;900&display=swap" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <style>
        *, *::before, *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        :root {
            --font-heading: 'Poppins', sans-serif;
            --font-body: 'Inter', sans-serif;
            --font-nepali: 'Noto Sans Devanagari', sans-serif;
            
            --bg-primary: #ffffff;
            --bg-secondary: #f8fafc;
            --bg-tertiary: #f1f5f9;
            --bg-dark: #0f172a;
            
            --text-primary: #0f172a;
            --text-secondary: #475569;
            --text-muted: #94a3b8;
            --text-white: #ffffff;
            
            --border-light: #e2e8f0;
            --border-medium: #cbd5e1;
            
            --accent-primary: #6366f1;
            --accent-secondary: #8b5cf6;
            --accent-gradient: linear-gradient(135deg, #6366f1 0%, #8b5cf6 50%, #a855f7 100%);
            --accent-gradient-hover: linear-gradient(135deg, #4f46e5 0%, #7c3aed 50%, #9333ea 100%);
            
            --saturday: #ef4444;
            --sunday: #3b82f6;
            --today: #f59e0b;
            --event: #ef4444;
            --success: #10b981;
            
            --shadow-sm: 0 1px 3px rgba(0,0,0,0.1);
            --shadow-md: 0 4px 6px -1px rgba(0,0,0,0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0,0,0,0.1);
            --shadow-xl: 0 20px 25px -5px rgba(0,0,0,0.1);
            --shadow-2xl: 0 25px 50px -12px rgba(0,0,0,0.25);
            --shadow-glow: 0 0 40px rgba(99, 102, 241, 0.15);
            
            --radius-sm: 6px;
            --radius-md: 10px;
            --radius-lg: 14px;
            --radius-xl: 20px;
            --radius-2xl: 28px;
            --radius-full: 9999px;
            
            --transition-fast: 150ms ease;
            --transition-base: 200ms ease;
            --transition-slow: 300ms ease;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: var(--font-nepali);
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
            -webkit-font-smoothing: antialiased;
            display: flex;
            flex-direction: column;
        }

        /* ============================================
           Preloader
           ============================================ */
        .preloader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--bg-primary);
            z-index: 99999;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            gap: 24px;
            transition: opacity 0.4s ease, visibility 0.4s ease;
        }

        .preloader.loaded {
            opacity: 0;
            visibility: hidden;
        }

        .preloader-bar {
            position: absolute;
            top: 0;
            left: 0;
            width: 0%;
            height: 3px;
            background: var(--accent-gradient);
            box-shadow: 0 0 10px rgba(99, 102, 241, 0.5);
            animation: preloaderProgress 1.5s ease-out forwards;
        }

        @keyframes preloaderProgress {
            0% { width: 0%; }
            20% { width: 25%; }
            50% { width: 60%; }
            80% { width: 85%; }
            100% { width: 100%; }
        }

        .preloader-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }

        .preloader-logo {
            width: 100px;
            height: 100px;
            animation: preloaderPulse 1s ease-in-out infinite;
        }

        @keyframes preloaderPulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.05); opacity: 0.8; }
        }

        .preloader-text {
            font-family: var(--font-nepali);
            font-size: 24px;
            font-weight: 700;
            background: var(--accent-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .preloader-subtext {
            font-family: var(--font-body);
            font-size: 14px;
            color: var(--text-muted);
            margin-top: -10px;
        }

        .preloader-dots {
            display: flex;
            gap: 8px;
        }

        .preloader-dot {
            width: 10px;
            height: 10px;
            background: var(--accent-primary);
            border-radius: 50%;
            animation: preloaderBounce 1.4s ease-in-out infinite;
        }

        .preloader-dot:nth-child(1) { animation-delay: 0s; }
        .preloader-dot:nth-child(2) { animation-delay: 0.2s; }
        .preloader-dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes preloaderBounce {
            0%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-12px); }
        }

        /* ============================================
           Scroll Progress Bar
           ============================================ */
        .scroll-progress {
            position: fixed;
            top: 0;
            left: 0;
            width: 0%;
            height: 3px;
            background: var(--accent-gradient);
            z-index: 10000;
            transition: width 0.1s linear;
        }

        /* Background */
        .page-bg {
            position: fixed;
            inset: 0;
            background: 
                radial-gradient(ellipse 80% 50% at 50% -20%, rgba(99, 102, 241, 0.12), transparent),
                radial-gradient(ellipse 60% 40% at 100% 50%, rgba(139, 92, 246, 0.08), transparent),
                radial-gradient(ellipse 60% 40% at 0% 80%, rgba(168, 85, 247, 0.06), transparent);
            pointer-events: none;
            z-index: -1;
        }

        .page-grid {
            position: fixed;
            inset: 0;
            background-image: 
                linear-gradient(rgba(99, 102, 241, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(99, 102, 241, 0.03) 1px, transparent 1px);
            background-size: 60px 60px;
            pointer-events: none;
            z-index: -1;
        }

        /* ============================================
           Navigation
           ============================================ */
        .nav {
            position: sticky;
            top: 3px;
            z-index: 1000;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--border-light);
            padding: 0 24px;
        }

        .nav-container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            height: 64px;
        }

        .nav-brand {
            display: flex;
            align-items: center;
            gap: 12px;
            text-decoration: none;
        }

        .nav-logo {
            width: 36px;
            height: 36px;
        }

        .nav-links {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nav-link {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 8px 16px;
            font-family: var(--font-body);
            font-size: 14px;
            font-weight: 500;
            color: var(--text-secondary);
            text-decoration: none;
            border-radius: var(--radius-md);
            transition: all var(--transition-base);
        }

        .nav-link:hover {
            background: var(--bg-secondary);
            color: var(--accent-primary);
        }

        .nav-link.active {
            background: rgba(99, 102, 241, 0.1);
            color: var(--accent-primary);
        }

        .nav-link i {
            width: 18px;
            height: 18px;
        }

        .nav-cta {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 8px 18px;
            background: var(--accent-gradient);
            color: white;
            font-family: var(--font-body);
            font-size: 14px;
            font-weight: 600;
            text-decoration: none;
            border-radius: var(--radius-md);
            transition: all var(--transition-base);
            box-shadow: 0 2px 8px rgba(99, 102, 241, 0.3);
        }

        .nav-cta:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.4);
        }

        .nav-cta i {
            width: 16px;
            height: 16px;
        }

        .nav-mobile-toggle {
            display: none;
            padding: 8px;
            background: none;
            border: none;
            cursor: pointer;
            color: var(--text-primary);
        }

        .nav-mobile-toggle i {
            width: 24px;
            height: 24px;
        }

        /* Mobile Menu */
        .mobile-menu {
            display: none;
            position: absolute;
            top: 64px;
            left: 0;
            right: 0;
            background: var(--bg-primary);
            border-bottom: 1px solid var(--border-light);
            padding: 16px;
            flex-direction: column;
            gap: 8px;
            box-shadow: var(--shadow-lg);
        }

        .mobile-menu.active {
            display: flex;
        }

        .mobile-menu .nav-link,
        .mobile-menu .nav-cta {
            width: 100%;
            justify-content: flex-start;
        }

        /* ============================================
           Main Layout - Three Column
           ============================================ */
        .main-wrapper {
            max-width: 1400px;
            width: 100%;
            margin: 0 auto;
            padding: 20px 16px;
            flex: 1;
            display: grid;
            grid-template-columns: 320px 1fr 320px;
            gap: 24px;
        }

        /* ============================================
           Left Sidebar - Today's Info
           ============================================ */
        .today-sidebar {
            position: sticky;
            top: 84px;
            height: fit-content;
        }

        .today-card {
            background: var(--bg-primary);
            border-radius: var(--radius-2xl);
            overflow: hidden;
            box-shadow: var(--shadow-xl), var(--shadow-glow);
            border: 1px solid var(--border-light);
        }

        .today-header {
            background: var(--accent-gradient);
            padding: 24px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .today-header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -30%;
            width: 100%;
            height: 150%;
            background: radial-gradient(circle, rgba(255,255,255,0.15) 0%, transparent 60%);
            pointer-events: none;
        }

        .today-label {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 14px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: var(--radius-full);
            font-size: 11px;
            font-weight: 600;
            color: white;
            margin-bottom: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .today-label i {
            width: 14px;
            height: 14px;
        }

        .today-date-big {
            font-size: 80px;
            font-weight: 900;
            color: white;
            line-height: 1;
            text-shadow: 0 4px 20px rgba(0,0,0,0.15);
            position: relative;
            z-index: 1;
        }

        .today-day-name {
            font-size: 24px;
            font-weight: 700;
            color: rgba(255, 255, 255, 0.95);
            margin-top: 8px;
            position: relative;
            z-index: 1;
        }

        .today-month-year {
            font-size: 18px;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.85);
            margin-top: 4px;
            position: relative;
            z-index: 1;
        }

        .today-body {
            padding: 20px;
        }

        .today-english-date {
            text-align: center;
            padding: 12px;
            background: var(--bg-secondary);
            border-radius: var(--radius-md);
            margin-bottom: 16px;
        }

        .today-english-date-text {
            font-family: var(--font-body);
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .today-time {
            text-align: center;
            padding: 16px;
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.1) 0%, rgba(139, 92, 246, 0.1) 100%);
            border-radius: var(--radius-md);
            margin-bottom: 16px;
        }

        .today-time-value {
            font-size: 28px;
            font-weight: 800;
            color: var(--accent-primary);
            font-family: var(--font-nepali);
        }

        .today-tithi-row {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 12px;
            background: var(--bg-secondary);
            border-radius: var(--radius-md);
            margin-bottom: 16px;
        }

        .today-tithi-icon {
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--accent-gradient);
            border-radius: var(--radius-sm);
            color: white;
            font-size: 14px;
        }

        .today-tithi-text {
            font-size: 16px;
            font-weight: 700;
            color: var(--text-primary);
        }

        .today-events {
            padding: 16px;
            background: rgba(239, 68, 68, 0.05);
            border: 1px solid rgba(239, 68, 68, 0.1);
            border-radius: var(--radius-md);
            margin-bottom: 16px;
        }

        .today-events-title {
            font-size: 11px;
            font-weight: 700;
            color: var(--saturday);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .today-events-title i {
            width: 14px;
            height: 14px;
        }

        .today-events-list {
            font-size: 13px;
            font-weight: 600;
            color: var(--text-primary);
            line-height: 1.6;
        }

        .today-sun-weather {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }

        .sun-card {
            padding: 14px;
            background: var(--bg-secondary);
            border-radius: var(--radius-md);
            text-align: center;
        }

        .sun-card-icon {
            width: 36px;
            height: 36px;
            margin: 0 auto 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #f59e0b 0%, #ef4444 100%);
            border-radius: var(--radius-sm);
            color: white;
            font-size: 16px;
        }

        .sun-card.sunset .sun-card-icon {
            background: linear-gradient(135deg, #ef4444 0%, #7c3aed 100%);
        }

        .sun-card-label {
            font-size: 11px;
            color: var(--text-muted);
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .sun-card-value {
            font-size: 14px;
            font-weight: 700;
            color: var(--text-primary);
            margin-top: 4px;
        }

        .weather-card {
            grid-column: span 2;
            padding: 16px;
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-top: 12px;
        }

        .weather-left {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .weather-icon {
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.2);
            border-radius: var(--radius-md);
            font-size: 24px;
        }

        .weather-temp {
            font-size: 28px;
            font-weight: 800;
            color: white;
        }

        .weather-right {
            text-align: right;
        }

        .weather-location {
            font-size: 14px;
            font-weight: 600;
            color: white;
        }

        .weather-condition {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.8);
            margin-top: 2px;
        }

        /* ============================================
           Calendar Container (Center)
           ============================================ */
        .calendar-wrapper {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        /* Banner Image - Simple */
        .calendar-banner-img {
            width: 100%;
            height: 120px;
            border-radius: var(--radius-xl);
            object-fit: cover;
            object-position: center;
            display: block;
            box-shadow: var(--shadow-lg);
        }

        .calendar-container {
            background: var(--bg-primary);
            border-radius: var(--radius-2xl);
            overflow: hidden;
            box-shadow: var(--shadow-xl), var(--shadow-glow);
            border: 1px solid var(--border-light);
        }

        /* Calendar Header */
        .calendar-header {
            background: var(--accent-gradient);
            padding: 24px 28px;
            position: relative;
            overflow: hidden;
        }

        .calendar-header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -30%;
            width: 100%;
            height: 150%;
            background: radial-gradient(circle, rgba(255,255,255,0.15) 0%, transparent 60%);
            pointer-events: none;
        }

        .nav-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
            z-index: 1;
        }

        .nav-btn {
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.25);
            border-radius: var(--radius-md);
            color: white;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .nav-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.05);
        }

        .nav-btn:active {
            transform: scale(0.95);
        }

        .nav-btn i {
            width: 24px;
            height: 24px;
        }

        .title-center {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
        }

        .month-year-row {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .month-btn, .year-btn {
            background: rgba(255, 255, 255, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: var(--radius-md);
            padding: 10px 20px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-family: var(--font-nepali);
            font-size: 22px;
            font-weight: 800;
            color: white;
        }

        .month-btn:hover, .year-btn:hover {
            background: rgba(255, 255, 255, 0.25);
        }

        .title-english {
            font-size: 13px;
            color: rgba(255, 255, 255, 0.85);
            font-family: var(--font-body);
            font-weight: 500;
        }

        /* Weekdays */
        .weekdays {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-light);
        }

        .weekday {
            padding: 14px 8px;
            text-align: center;
            font-size: 15px;
            font-weight: 800;
            color: var(--text-secondary);
        }

        .weekday-eng {
            display: block;
            font-size: 10px;
            color: var(--text-muted);
            font-family: var(--font-body);
            margin-top: 2px;
        }

        .weekday.saturday .weekday-nep { color: var(--saturday); }
        .weekday.sunday .weekday-nep { color: var(--sunday); }

        /* Calendar Days - Bigger & Bolder */
        .calendar-days {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 8px;
            padding: 16px;
            background: var(--bg-primary);
        }

        .day {
            aspect-ratio: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border-radius: var(--radius-lg);
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
            background: var(--bg-secondary);
            border: 2px solid transparent;
            min-height: 70px;
        }

        .day:hover:not(.empty) {
            background: var(--bg-tertiary);
            border-color: var(--accent-primary);
            transform: scale(1.08);
            z-index: 2;
            box-shadow: var(--shadow-lg);
        }

        .day.empty {
            background: transparent;
            cursor: default;
        }

        .day.today {
            background: rgba(245, 158, 11, 0.15);
            border: 3px solid var(--today);
            box-shadow: 0 0 20px rgba(245, 158, 11, 0.25);
        }

        .day.today .day-num {
            color: var(--today);
        }

        .day.selected {
            background: var(--accent-gradient);
            border-color: transparent;
            transform: scale(1.08);
            box-shadow: var(--shadow-lg), 0 0 25px rgba(99, 102, 241, 0.35);
        }

        .day.selected .day-num,
        .day.selected .day-eng,
        .day.selected .day-tithi {
            color: white !important;
        }

        .day.has-event::before {
            content: '';
            position: absolute;
            top: 6px;
            right: 6px;
            width: 8px;
            height: 8px;
            background: var(--event);
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        .day.selected.has-event::before {
            background: white;
        }

        .day.holiday .day-num {
            color: var(--saturday) !important;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.6; transform: scale(1.2); }
        }

        .day-num {
            font-size: 24px;
            font-weight: 900;
            color: var(--text-primary);
            line-height: 1;
        }

        .day-eng {
            font-size: 11px;
            color: var(--text-muted);
            font-family: var(--font-body);
            font-weight: 600;
            margin-top: 4px;
        }

        .day-tithi {
            font-size: 9px;
            color: var(--accent-primary);
            font-weight: 600;
            margin-top: 3px;
            max-width: 95%;
            text-align: center;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .day.saturday .day-num { color: var(--saturday); }
        .day.sunday .day-num { color: var(--sunday); }

        /* Events Strip */
        .events-strip {
            background: var(--bg-secondary);
            border-top: 1px solid var(--border-light);
            padding: 16px 20px;
        }

        .events-strip-title {
            font-size: 12px;
            font-weight: 700;
            color: var(--text-muted);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 6px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .events-strip-title i {
            width: 14px;
            height: 14px;
            color: var(--accent-primary);
        }

        .events-row {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .event-chip {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 8px 14px;
            background: var(--bg-primary);
            border: 1px solid var(--border-light);
            border-radius: var(--radius-full);
            font-size: 12px;
            font-weight: 600;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .event-chip:hover {
            border-color: var(--accent-primary);
            background: rgba(99, 102, 241, 0.05);
            transform: translateY(-2px);
            box-shadow: var(--shadow-sm);
        }

        .event-chip.holiday {
            background: rgba(239, 68, 68, 0.05);
            border-color: rgba(239, 68, 68, 0.2);
        }

        .event-chip.holiday:hover {
            border-color: var(--saturday);
        }

        .event-chip-date {
            font-weight: 800;
            color: var(--accent-primary);
        }

        .event-chip.holiday .event-chip-date {
            color: var(--saturday);
        }

        .no-events {
            text-align: center;
            color: var(--text-muted);
            font-size: 12px;
            padding: 10px;
        }

        /* ============================================
           Right Sidebar - Upcoming Events
           ============================================ */
        .upcoming-sidebar {
            position: sticky;
            top: 84px;
            height: fit-content;
        }

        .upcoming-card {
            background: var(--bg-primary);
            border-radius: var(--radius-2xl);
            overflow: hidden;
            box-shadow: var(--shadow-xl), var(--shadow-glow);
            border: 1px solid var(--border-light);
        }

        .upcoming-header {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            border-bottom: 1px solid var(--border-light);
        }

        .upcoming-title {
            font-size: 16px;
            font-weight: 800;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .upcoming-title i {
            width: 20px;
            height: 20px;
            color: var(--accent-primary);
        }

        .upcoming-list {
            padding: 12px;
            max-height: 650px;
            overflow-y: auto;
        }

        .upcoming-item {
            display: flex;
            gap: 14px;
            padding: 14px;
            border-radius: var(--radius-md);
            transition: all 0.2s ease;
            cursor: pointer;
            border: 1px solid transparent;
        }

        .upcoming-item:hover {
            background: var(--bg-secondary);
            border-color: var(--border-light);
        }

        .upcoming-item.today-item {
            background: rgba(99, 102, 241, 0.08);
            border-color: rgba(99, 102, 241, 0.2);
        }

        .upcoming-date-box {
            width: 56px;
            min-width: 56px;
            text-align: center;
            padding: 10px 8px;
            background: var(--bg-secondary);
            border-radius: var(--radius-md);
            border: 1px solid var(--border-light);
        }

        .upcoming-item.today-item .upcoming-date-box {
            background: var(--accent-gradient);
            border-color: transparent;
        }

        .upcoming-date-day {
            font-size: 11px;
            font-weight: 700;
            color: var(--text-muted);
            text-transform: uppercase;
        }

        .upcoming-date-num {
            font-size: 22px;
            font-weight: 900;
            color: var(--text-primary);
            line-height: 1.2;
        }

        .upcoming-date-tithi {
            font-size: 10px;
            color: var(--accent-primary);
            font-weight: 600;
        }

        .upcoming-item.today-item .upcoming-date-day,
        .upcoming-item.today-item .upcoming-date-num,
        .upcoming-item.today-item .upcoming-date-tithi {
            color: white;
        }

        .upcoming-info {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            gap: 4px;
        }

        .upcoming-badge {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 3px 8px;
            background: var(--accent-gradient);
            border-radius: var(--radius-full);
            font-size: 10px;
            font-weight: 700;
            color: white;
            width: fit-content;
        }

        .upcoming-badge.today-badge {
            background: linear-gradient(135deg, #10b981, #059669);
        }

        .upcoming-badge i {
            width: 12px;
            height: 12px;
        }

        .upcoming-event-name {
            font-size: 13px;
            font-weight: 600;
            color: var(--text-primary);
            line-height: 1.4;
        }

        .upcoming-no-events {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-muted);
        }

        .upcoming-no-events i {
            width: 48px;
            height: 48px;
            margin-bottom: 12px;
            opacity: 0.4;
        }

        /* ============================================
           Footer
           ============================================ */
        .footer {
            padding: 80px 24px 40px;
            background: var(--bg-dark);
        }

        .footer-container {
            max-width: 1100px;
            margin: 0 auto;
        }

        .footer-main {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr;
            gap: 48px;
            padding-bottom: 48px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .footer-brand {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .footer-logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .footer-logo img {
            width: 48px;
            height: 48px;
        }

        .footer-logo-text {
            font-family: var(--font-heading);
            font-size: 20px;
            font-weight: 700;
            color: white;
        }

        .footer-logo-text span {
            color: var(--accent-primary);
        }

        .footer-desc {
            font-family: var(--font-body);
            font-size: 14px;
            color: #94a3b8;
            line-height: 1.7;
            max-width: 320px;
        }

        .footer-social {
            display: flex;
            gap: 12px;
            margin-top: 8px;
        }

        .footer-social-link {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-md);
            color: #94a3b8;
            text-decoration: none;
            transition: all var(--transition-base);
        }

        .footer-social-link:hover {
            background: var(--accent-primary);
            border-color: var(--accent-primary);
            color: white;
        }

        .footer-social-link i {
            font-size: 18px;
        }

        .footer-column h4 {
            font-family: var(--font-heading);
            font-size: 14px;
            font-weight: 700;
            color: white;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 20px;
        }

        .footer-links {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .footer-link {
            font-family: var(--font-body);
            font-size: 14px;
            color: #94a3b8;
            text-decoration: none;
            transition: color var(--transition-base);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .footer-link:hover {
            color: white;
        }

        .footer-link i {
            width: 16px;
            height: 16px;
        }

        .footer-bottom {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding-top: 32px;
            flex-wrap: wrap;
            gap: 16px;
        }

        .footer-copy {
            font-family: var(--font-body);
            font-size: 14px;
            color: #64748b;
        }

        .footer-copy a {
            color: var(--accent-primary);
            text-decoration: none;
        }

        .footer-copy a:hover {
            text-decoration: underline;
        }

        .footer-made {
            display: flex;
            align-items: center;
            gap: 8px;
            font-family: var(--font-body);
            font-size: 14px;
            color: #64748b;
        }

        .footer-made i {
            color: #ef4444;
        }

        .footer-made a {
            color: var(--accent-primary);
            text-decoration: none;
        }

        .footer-made a:hover {
            text-decoration: underline;
        }

        /* Install Button - Fixed Position */
        .install-popup {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 999;
            animation: slideUp 0.5s ease;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .install-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 12px 20px;
            background: var(--accent-gradient);
            border: none;
            border-radius: var(--radius-full);
            color: white;
            font-family: var(--font-body);
            font-size: 13px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 20px rgba(99, 102, 241, 0.4);
        }

        .install-btn:hover {
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 8px 30px rgba(99, 102, 241, 0.5);
        }

        .install-btn:active {
            transform: translateY(-1px) scale(0.98);
        }

        .install-btn i {
            width: 18px;
            height: 18px;
        }

        .install-btn .install-icon {
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-3px); }
        }

        .install-popup.hidden {
            display: none;
        }

        /* Picker Overlay */
        .picker-overlay {
            position: fixed;
            inset: 0;
            background: rgba(15, 23, 42, 0.5);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 16px;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .picker-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .picker-modal {
            background: var(--bg-primary);
            border-radius: var(--radius-xl);
            width: 100%;
            max-width: 400px;
            overflow: hidden;
            box-shadow: var(--shadow-2xl);
            transform: scale(0.9) translateY(20px);
            transition: all 0.3s ease;
        }

        .picker-overlay.active .picker-modal {
            transform: scale(1) translateY(0);
        }

        .picker-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px 20px;
            background: var(--accent-gradient);
            color: white;
        }

        .picker-title {
            font-size: 15px;
            font-weight: 700;
        }

        .picker-close {
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            border-radius: var(--radius-sm);
            color: white;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .picker-close:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .picker-close i {
            width: 16px;
            height: 16px;
        }

        .picker-nav {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 14px 20px;
            border-bottom: 1px solid var(--border-light);
        }

        .picker-nav-btn {
            width: 34px;
            height: 34px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--bg-secondary);
            border: 1px solid var(--border-light);
            border-radius: var(--radius-sm);
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .picker-nav-btn:hover {
            background: var(--accent-primary);
            color: white;
            border-color: var(--accent-primary);
        }

        .picker-nav-btn i {
            width: 16px;
            height: 16px;
        }

        .picker-range {
            font-size: 14px;
            font-weight: 700;
            color: var(--text-primary);
        }

        .picker-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            padding: 18px 20px;
            max-height: 300px;
            overflow-y: auto;
        }

        .picker-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 14px 8px;
            background: var(--bg-secondary);
            border: 2px solid transparent;
            border-radius: var(--radius-sm);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .picker-item:hover:not(.disabled) {
            background: var(--bg-tertiary);
            border-color: var(--accent-primary);
            transform: scale(1.05);
        }

        .picker-item.selected {
            background: var(--accent-gradient);
            border-color: transparent;
        }

        .picker-item.current:not(.selected) {
            border-color: var(--today);
        }

        .picker-item.disabled {
            opacity: 0.35;
            cursor: not-allowed;
        }

        .picker-item-nep {
            font-size: 14px;
            font-weight: 700;
            color: var(--text-primary);
        }

        .picker-item-eng {
            font-size: 10px;
            color: var(--text-muted);
            font-family: var(--font-body);
            margin-top: 2px;
        }

        .picker-item.selected .picker-item-nep,
        .picker-item.selected .picker-item-eng {
            color: white;
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 16px;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal {
            background: var(--bg-primary);
            border-radius: var(--radius-xl);
            width: 100%;
            max-width: 400px;
            overflow: hidden;
            box-shadow: var(--shadow-2xl);
            transform: scale(0.9) translateY(20px);
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .modal-overlay.active .modal {
            transform: scale(1) translateY(0);
        }

        .modal-header {
            background: var(--accent-gradient);
            padding: 28px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .modal-header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -30%;
            width: 100%;
            height: 150%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 50%);
            pointer-events: none;
        }

        .modal-close {
            position: absolute;
            top: 14px;
            right: 14px;
            width: 34px;
            height: 34px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            border-radius: var(--radius-sm);
            color: white;
            cursor: pointer;
            transition: all 0.2s ease;
            z-index: 1;
        }

        .modal-close:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: rotate(90deg);
        }

        .modal-close i {
            width: 18px;
            height: 18px;
        }

        .modal-date {
            position: relative;
            z-index: 1;
        }

        .modal-day-big {
            font-size: 60px;
            font-weight: 900;
            color: white;
            line-height: 1;
            text-shadow: 0 4px 20px rgba(0,0,0,0.15);
        }

        .modal-month-year {
            font-size: 20px;
            font-weight: 700;
            color: rgba(255, 255, 255, 0.95);
            margin-top: 8px;
        }

        .modal-day-name {
            display: inline-block;
            margin-top: 12px;
            padding: 7px 20px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: var(--radius-full);
            font-size: 13px;
            font-weight: 600;
            color: white;
        }

        .modal-body {
            padding: 20px;
        }

        .modal-info-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-bottom: 20px;
        }

        .modal-info-item {
            padding: 14px;
            background: var(--bg-secondary);
            border-radius: var(--radius-sm);
            text-align: center;
        }

        .modal-info-label {
            font-size: 10px;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: 600;
        }

        .modal-info-value {
            font-size: 15px;
            font-weight: 700;
            color: var(--text-primary);
            margin-top: 4px;
        }

        .modal-section-title {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 13px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 14px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-light);
        }

        .modal-section-title i {
            width: 16px;
            height: 16px;
            color: var(--accent-primary);
        }

        .modal-events {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .modal-event {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px;
            background: var(--bg-secondary);
            border-radius: var(--radius-sm);
            border-left: 3px solid var(--accent-primary);
        }

        .modal-event.holiday {
            border-left-color: var(--saturday);
            background: rgba(239, 68, 68, 0.05);
        }

        .modal-event-icon {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--accent-gradient);
            border-radius: var(--radius-sm);
            color: white;
            font-size: 15px;
        }

        .modal-event.holiday .modal-event-icon {
            background: linear-gradient(135deg, #ef4444, #f97316);
        }

        .modal-event-name {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .modal-event-type {
            font-size: 11px;
            color: var(--text-muted);
            margin-top: 2px;
        }

        .modal-no-events {
            text-align: center;
            padding: 28px;
            color: var(--text-muted);
        }

        .modal-no-events i {
            width: 44px;
            height: 44px;
            margin-bottom: 10px;
            opacity: 0.4;
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 5px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-secondary);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--border-medium);
            border-radius: 3px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--accent-primary);
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .main-wrapper {
                grid-template-columns: 1fr;
                max-width: 800px;
            }

            .today-sidebar,
            .upcoming-sidebar {
                position: static;
            }

            .today-sidebar {
                order: -1;
            }

            .calendar-wrapper {
                order: 0;
            }

            .upcoming-sidebar {
                order: 1;
            }

            .footer-main {
                grid-template-columns: 1fr 1fr;
            }

            .upcoming-list {
                max-height: 400px;
            }
        }

        @media (max-width: 768px) {
            .nav-links {
                display: none;
            }

            .nav-mobile-toggle {
                display: flex;
            }

            .footer-main {
                grid-template-columns: 1fr;
                gap: 32px;
            }

            .footer-bottom {
                flex-direction: column;
                text-align: center;
            }

            .today-date-big {
                font-size: 60px;
            }

            .today-day-name {
                font-size: 20px;
            }

            .today-month-year {
                font-size: 16px;
            }

            .upcoming-list {
                max-height: 350px;
            }
        }

        @media (max-width: 600px) {
            .nav {
                padding: 0 16px;
            }

            .nav-container {
                height: 56px;
            }

            .main-wrapper {
                padding: 14px 12px;
            }

            .calendar-header {
                padding: 20px;
            }

            .month-btn, .year-btn {
                font-size: 18px;
                padding: 8px 14px;
            }

            .nav-btn {
                width: 42px;
                height: 42px;
            }

            .calendar-days {
                padding: 12px;
                gap: 6px;
            }

            .day {
                min-height: 60px;
            }

            .day-num {
                font-size: 20px;
            }

            .day-eng {
                font-size: 10px;
            }

            .day-tithi {
                font-size: 8px;
            }

            .weekday {
                padding: 12px 6px;
                font-size: 14px;
            }

            .events-strip {
                padding: 14px 16px;
            }

            .event-chip {
                padding: 6px 12px;
                font-size: 11px;
            }

            .modal-day-big {
                font-size: 52px;
            }

            .modal-month-year {
                font-size: 18px;
            }

            .modal-header {
                padding: 24px;
            }

            .modal-body {
                padding: 16px;
            }

            .picker-grid {
                grid-template-columns: repeat(3, 1fr);
            }

            .footer {
                padding: 60px 20px 30px;
            }

            .install-popup {
                bottom: 16px;
                right: 16px;
            }

            .install-btn {
                padding: 10px 16px;
                font-size: 12px;
            }

            .install-btn i {
                width: 16px;
                height: 16px;
            }

            .calendar-banner-img {
                height: 100px;
            }

            .today-header {
                padding: 20px;
            }

            .today-date-big {
                font-size: 56px;
            }

            .today-body {
                padding: 16px;
            }

            .today-time-value {
                font-size: 24px;
            }

            .weather-temp {
                font-size: 24px;
            }

            .upcoming-list {
                max-height: 300px;
            }
        }

        @media (max-width: 420px) {
            .day-num {
                font-size: 16px;
            }

            .day-eng {
                font-size: 9px;
            }

            .day-tithi {
                display: none;
            }

            .day {
                min-height: 50px;
            }

            .calendar-days {
                gap: 4px;
                padding: 10px;
            }

            .month-btn, .year-btn {
                font-size: 16px;
                padding: 6px 12px;
            }

            .weekday {
                font-size: 12px;
                padding: 10px 4px;
            }

            .weekday-eng {
                font-size: 8px;
            }

            .install-popup {
                bottom: 12px;
                right: 12px;
                left: 12px;
            }

            .install-btn {
                width: 100%;
                justify-content: center;
            }

            .today-sun-weather {
                grid-template-columns: 1fr;
            }

            .weather-card {
                grid-column: span 1;
            }

            .calendar-banner-img {
                height: 80px;
            }
        }
    </style>
</head>
<body>
    <!-- Preloader -->
    <div class="preloader" id="preloader">
        <div class="preloader-bar"></div>
        <div class="preloader-content">
            <img src="MainLogo.png" alt="Loading" class="preloader-logo">
            <span class="preloader-text"> </span>
            <span class="preloader-subtext">By Om Pandey</span>
            <div class="preloader-dots">
                <div class="preloader-dot"></div>
                <div class="preloader-dot"></div>
                <div class="preloader-dot"></div>
            </div>
        </div>
    </div>

    <!-- Scroll Progress Bar -->
    <div class="scroll-progress" id="scrollProgress"></div>

    <!-- Background -->
    <div class="page-bg"></div>
    <div class="page-grid"></div>

    <!-- Navigation -->
    <nav class="nav" role="navigation" aria-label="Main Navigation">
        <div class="nav-container">
            <a href="#" class="nav-brand">
                <img src="MainLogo.png" alt="Nepali Calendar" class="nav-logo">
            </a>
            
            <div class="nav-links">
                <a href="index.html" class="nav-link active">
                    <i data-lucide="calendar-days"></i>
                    Calendar
                </a>
                <a href="datepicker.html" class="nav-link">
                    <i data-lucide="calendar-check"></i>
                    Date Picker
                </a>
                <a href="dateconverter.html" class="nav-link">
                    <i data-lucide="arrow-left-right"></i>
                    Converter
                </a>
                <a href="Support.html" target="_blank" class="nav-cta">
                    <i data-lucide="coffee"></i>
                    Support Me
                </a>
                <a href="https://github.com/ompandey07/nepali-datepicker" target="_blank" rel="noopener noreferrer" class="nav-cta">
                    <i data-lucide="github"></i>
                    GitHub
                </a>
            </div>

            <button class="nav-mobile-toggle" id="mobileToggle" aria-label="Toggle menu">
                <i data-lucide="menu"></i>
            </button>
        </div>

        <!-- Mobile Menu -->
        <div class="mobile-menu" id="mobileMenu">
            <a href="index.html" class="nav-link active">
                <i data-lucide="calendar-days"></i>
                Calendar
            </a>
            <a href="datepicker.html" class="nav-link">
                <i data-lucide="calendar-check"></i>
                Date Picker
            </a>
            <a href="dateconverter.html" class="nav-link">
                <i data-lucide="arrow-left-right"></i>
                Converter
            </a>
            <a href="Support.html" target="_blank" class="nav-cta">
                <i data-lucide="coffee"></i>
                Support Me
            </a>
            <a href="https://github.com/ompandey07/nepali-datepicker" target="_blank" rel="noopener noreferrer" class="nav-cta">
                <i data-lucide="github"></i>
                GitHub
            </a>
        </div>
    </nav>

    <!-- Main -->
    <main class="main-wrapper">
        <!-- Left Sidebar - Today's Info -->
        <aside class="today-sidebar">
            <div class="today-card">
                <div class="today-header">
                    <div class="today-label">
                        <i data-lucide="calendar-heart"></i>
                          
                    </div>
                    <div class="today-date-big" id="todayDateBig">--</div>
                    <div class="today-day-name" id="todayDayName">--</div>
                    <div class="today-month-year" id="todayMonthYear">--</div>
                </div>
                <div class="today-body">
                    <div class="today-english-date">
                        <div class="today-english-date-text" id="todayEnglishDate">--</div>
                    </div>
                    
                    <div class="today-time">
                        <div class="today-time-value" id="todayTime">--</div>
                    </div>
                    
                    <div class="today-tithi-row">
                        <div class="today-tithi-icon">
                            <i class="fas fa-moon"></i>
                        </div>
                        <div class="today-tithi-text" id="todayTithi">--</div>
                    </div>
                    
                    <div class="today-events" id="todayEventsBox" style="display: none;">
                        <div class="today-events-title">
                            <i data-lucide="sparkles"></i>
                             
                        </div>
                        <div class="today-events-list" id="todayEventsList">--</div>
                    </div>
                    
                    <div class="today-sun-weather">
                        <div class="sun-card">
                            <div class="sun-card-icon">
                                <i class="fas fa-sun"></i>
                            </div>
                            <div class="sun-card-label"></div>
                            <div class="sun-card-value" id="sunriseTime">--</div>
                        </div>
                        <div class="sun-card sunset">
                            <div class="sun-card-icon">
                                <i class="fas fa-moon"></i>
                            </div>
                            <div class="sun-card-label"></div>
                            <div class="sun-card-value" id="sunsetTime">--</div>
                        </div>
                        <div class="weather-card" id="weatherCard">
                            <div class="weather-left">
                                <div class="weather-icon" id="weatherIcon">
                                    <i class="fas fa-cloud-sun"></i>
                                </div>
                                <div class="weather-temp" id="weatherTemp">--C</div>
                            </div>
                            <div class="weather-right">
                                <div class="weather-location">Kathmandu</div>
                                <div class="weather-condition" id="weatherCondition">Loading...</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Calendar (Center) -->
        <div class="calendar-wrapper">
            <!-- Banner Image - Simple -->
            <img src="Banner.png" alt="Nepali Calendar Banner" class="calendar-banner-img">

            <div class="calendar-container">
                <!-- Calendar Header -->
                <div class="calendar-header">
                    <div class="nav-row">
                        <button class="nav-btn" id="prevMonth">
                            <i data-lucide="chevron-left"></i>
                        </button>
                        <div class="title-center">
                            <div class="month-year-row">
                                <button class="month-btn" id="monthBtn">--</button>
                                <button class="year-btn" id="yearBtn">--</button>
                            </div>
                            <span class="title-english" id="titleEnglish">--</span>
                        </div>
                        <button class="nav-btn" id="nextMonth">
                            <i data-lucide="chevron-right"></i>
                        </button>
                    </div>
                </div>

                <!-- Weekdays -->
                <div class="weekdays" id="weekdays"></div>

                <!-- Calendar Days -->
                <div class="calendar-days" id="calendarDays"></div>

                <!-- Events Strip -->
                <div class="events-strip">
                    <div class="events-strip-title">
                        <i data-lucide="bell"></i>
                          
                    </div>
                    <div class="events-row" id="eventsRow"></div>
                </div>
            </div>
        </div>

        <!-- Right Sidebar - Upcoming Events -->
        <aside class="upcoming-sidebar">
            <div class="upcoming-card">
                <div class="upcoming-header">
                    <div class="upcoming-title">
                        <i data-lucide="calendar-clock"></i>
                         
                    </div>
                </div>
                <div class="upcoming-list" id="upcomingList">
                    <!-- Will be populated by JS -->
                </div>
            </div>
        </aside>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-container">
            <div class="footer-main">
                <div class="footer-brand">
                    <div class="footer-logo">
                        <img src="MainLogo.png" alt="Nepali Calendar">
                        <span class="footer-logo-text">Nepali<span>Calendar</span></span>
                    </div>
                    <p class="footer-desc">
                        A beautiful, modern Nepali (Bikram Sambat) calendar with Tithi, events, and festivals. 
                        Open source and free to use.
                    </p>
                    <div class="footer-social">
                        <a href="https://github.com/ompandey07" target="_blank" rel="noopener noreferrer" class="footer-social-link">
                            <i class="fab fa-github"></i>
                        </a>
                        <a href="https://www.linkedin.com/in/iamompandey/" target="_blank" rel="noopener noreferrer" class="footer-social-link">
                            <i class="fab fa-linkedin-in"></i>
                        </a>
                        <a href="https://x.com/iam_ompandey" target="_blank" rel="noopener noreferrer" class="footer-social-link">
                            <i class="fab fa-x-twitter"></i>
                        </a>
                        <a href="https://www.instagram.com/ome.exee/" target="_blank" rel="noopener noreferrer" class="footer-social-link">
                            <i class="fab fa-instagram"></i>
                        </a>
                    </div>
                </div>
                
                <div class="footer-column">
                    <h4>Navigation</h4>
                    <div class="footer-links">
                        <a href="index.html" class="footer-link">
                            <i data-lucide="calendar-days"></i>
                            Calendar
                        </a>
                        <a href="datepicker.html" class="footer-link">
                            <i data-lucide="calendar-check"></i>
                            Date Picker
                        </a>
                        <a href="dateconverter.html" class="footer-link">
                            <i data-lucide="arrow-left-right"></i>
                            Converter
                        </a>
                    </div>
                </div>
                
                <div class="footer-column">
                    <h4>Resources</h4>
                    <div class="footer-links">
                        <a href="https://github.com/ompandey07/nepali-datepicker" target="_blank" class="footer-link">
                            <i data-lucide="github"></i>
                            GitHub Repo
                        </a>
                        <a href="https://github.com/ompandey07/nepali-datepicker/issues" target="_blank" class="footer-link">
                            <i data-lucide="bug"></i>
                            Report Issues
                        </a>
                        <a href="https://cdn.jsdelivr.net/gh/ompandey07/nepali-datepicker@main/dist/" target="_blank" class="footer-link">
                            <i data-lucide="cloud"></i>
                            CDN Files
                        </a>
                    </div>
                </div>
                
                <div class="footer-column">
                    <h4>Developer</h4>
                    <div class="footer-links">
                        <a href="https://www.omkumarpandey.com.np/" target="_blank" class="footer-link">
                            <i data-lucide="globe"></i>
                            Portfolio
                        </a>
                        <a href="mailto:admin@omkumarpandey.com.np" class="footer-link">
                            <i data-lucide="mail"></i>
                            Contact
                        </a>
                        <a href="Support.html" target="_blank" class="footer-link">
                            <i data-lucide="coffee"></i>
                            Support Me
                        </a>
                    </div>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p class="footer-copy">
                     <span id="currentYear"></span> <a href="https://www.omkumarpandey.com.np/" target="_blank">Om Pandey</a>. 
                    All rights reserved. MIT License.
                </p>
                <p class="footer-made">
                    Made with <i class="fas fa-heart"></i> in Nepal by 
                    <a href="https://www.omkumarpandey.com.np/" target="_blank">Om Pandey</a>
                </p>
            </div>
        </div>
    </footer>

    <!-- Install Popup - Fixed at Right -->
    <div class="install-popup" id="installPopup">
        <button class="install-btn" id="installBtn">
            <i data-lucide="download" class="install-icon"></i>
            Install Calendar
        </button>
    </div>

    <!-- Year Picker -->
    <div class="picker-overlay" id="yearPicker">
        <div class="picker-modal">
            <div class="picker-header">
                <span class="picker-title"> </span>
                <button class="picker-close" id="yearPickerClose">
                    <i data-lucide="x"></i>
                </button>
            </div>
            <div class="picker-nav">
                <button class="picker-nav-btn" id="yearPrev">
                    <i data-lucide="chevron-left"></i>
                </button>
                <span class="picker-range" id="yearRange">--</span>
                <button class="picker-nav-btn" id="yearNext">
                    <i data-lucide="chevron-right"></i>
                </button>
            </div>
            <div class="picker-grid" id="yearGrid"></div>
        </div>
    </div>

    <!-- Month Picker -->
    <div class="picker-overlay" id="monthPicker">
        <div class="picker-modal">
            <div class="picker-header">
                <span class="picker-title"> </span>
                <button class="picker-close" id="monthPickerClose">
                    <i data-lucide="x"></i>
                </button>
            </div>
            <div class="picker-grid" id="monthGrid"></div>
        </div>
    </div>

    <!-- Date Detail Modal -->
    <div class="modal-overlay" id="modalOverlay">
        <div class="modal">
            <div class="modal-header">
                <button class="modal-close" id="modalClose">
                    <i data-lucide="x"></i>
                </button>
                <div class="modal-date">
                    <div class="modal-day-big" id="modalDay">--</div>
                    <div class="modal-month-year" id="modalMonthYear">--</div>
                    <div class="modal-day-name" id="modalDayName">--</div>
                </div>
            </div>
            <div class="modal-body">
                <div class="modal-info-grid">
                    <div class="modal-info-item">
                        <div class="modal-info-label">..</div>
                        <div class="modal-info-value" id="modalBS">--</div>
                    </div>
                    <div class="modal-info-item">
                        <div class="modal-info-label">..</div>
                        <div class="modal-info-value" id="modalAD">--</div>
                    </div>
                    <div class="modal-info-item">
                        <div class="modal-info-label"></div>
                        <div class="modal-info-value" id="modalTithi">--</div>
                    </div>
                    <div class="modal-info-item">
                        <div class="modal-info-label"></div>
                        <div class="modal-info-value" id="modalPaksha">--</div>
                    </div>
                </div>
                <div class="modal-section-title">
                    <i data-lucide="calendar-heart"></i>
                      
                </div>
                <div class="modal-events" id="modalEvents"></div>
            </div>
        </div>
    </div>

    <script>
        // ============================================
        // Preloader
        // ============================================
        window.addEventListener('load', function() {
            setTimeout(function() {
                document.getElementById('preloader').classList.add('loaded');
            }, 1500);
        });

        // ============================================
        // Scroll Progress
        // ============================================
        window.addEventListener('scroll', function() {
            const scrollTop = window.scrollY;
            const docHeight = document.documentElement.scrollHeight - window.innerHeight;
            const scrollPercent = (scrollTop / docHeight) * 100;
            document.getElementById('scrollProgress').style.width = scrollPercent + '%';
        });

        // ============================================
        // Current Year for Footer
        // ============================================
        document.getElementById('currentYear').textContent = new Date().getFullYear();

        // ============================================
        // Data
        // ============================================
        
        const BS_DATA = {
            2070: [31, 31, 32, 31, 31, 31, 30, 29, 30, 29, 30, 30],
            2071: [31, 31, 32, 31, 32, 30, 30, 29, 30, 29, 30, 30],
            2072: [31, 32, 31, 32, 31, 30, 30, 30, 29, 29, 30, 31],
            2073: [30, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 31],
            2074: [31, 31, 32, 31, 31, 31, 30, 29, 30, 29, 30, 30],
            2075: [31, 31, 32, 32, 31, 30, 30, 29, 30, 29, 30, 30],
            2076: [31, 32, 31, 32, 31, 30, 30, 30, 29, 29, 30, 31],
            2077: [30, 32, 31, 32, 31, 31, 29, 30, 29, 30, 29, 31],
            2078: [31, 31, 32, 31, 31, 31, 30, 29, 30, 29, 30, 30],
            2079: [31, 31, 32, 32, 31, 30, 30, 29, 30, 29, 30, 30],
            2080: [31, 32, 31, 32, 31, 30, 30, 30, 29, 29, 30, 31],
            2081: [31, 31, 31, 32, 31, 31, 29, 30, 30, 29, 30, 30],
            2082: [31, 31, 32, 31, 31, 31, 30, 29, 30, 29, 30, 30],
            2083: [31, 31, 32, 32, 31, 30, 30, 29, 30, 29, 30, 30],
            2084: [31, 32, 31, 32, 31, 30, 30, 30, 29, 29, 30, 31],
            2085: [31, 31, 31, 32, 31, 31, 29, 30, 30, 29, 30, 30],
            2086: [31, 31, 32, 31, 31, 31, 30, 29, 30, 29, 30, 30],
            2087: [31, 32, 31, 32, 31, 30, 30, 29, 30, 29, 30, 30],
            2088: [31, 32, 31, 32, 31, 30, 30, 30, 29, 29, 30, 31],
            2089: [31, 31, 31, 32, 31, 31, 30, 29, 30, 29, 30, 30],
            2090: [31, 31, 32, 31, 31, 31, 30, 29, 30, 29, 30, 30],
            2091: [31, 32, 31, 32, 31, 30, 30, 29, 30, 29, 30, 30],
            2092: [31, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 31],
            2093: [31, 31, 31, 32, 31, 31, 30, 29, 30, 29, 30, 30],
            2094: [31, 31, 32, 31, 31, 31, 30, 29, 30, 29, 30, 30],
            2095: [31, 32, 31, 32, 31, 30, 30, 30, 29, 29, 30, 30],
            2096: [31, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 31],
            2097: [31, 31, 32, 31, 31, 31, 30, 29, 30, 29, 30, 30],
            2098: [31, 31, 32, 31, 32, 30, 30, 29, 30, 29, 30, 30],
            2099: [31, 32, 31, 32, 31, 30, 30, 30, 29, 29, 30, 31]
        };

        const BS_REF = { year: 2070, month: 1, day: 1 };
        const AD_REF = new Date(2013, 3, 14);

        const NEP_DIGITS = ['', '', '', '', '', '', '', '', '', ''];
        const NEP_MONTHS = ['', '', '', '', '', '', '', '', '', '', '', ''];
        const ENG_MONTHS = ['Baisakh', 'Jestha', 'Ashar', 'Shrawan', 'Bhadra', 'Ashwin', 'Kartik', 'Mangsir', 'Poush', 'Magh', 'Falgun', 'Chaitra'];
        const ENG_MONTHS_FULL = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
        const NEP_DAYS = ['', '', '', '', '', '', ''];
        const ENG_DAYS = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
        const ENG_DAYS_FULL = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
        const NEP_DAYS_FULL = ['', '', '', '', '', '', ''];
        const NEP_DAYS_SHORT = ['', '', '', '', '', '', ''];

        const TITHIS = ['', '', '', '', '', '', '', '', '', '', '', '', '', '', ''];

        const NEPAL_EVENTS = {
            1: { 1: [{ name: ' ', type: ' ', holiday: true, icon: 'fa-star' }], 11: [{ name: ' ', type: ' ', holiday: true, icon: 'fa-flag' }] },
            2: { 1: [{ name: ' ', type: ' ', holiday: true, icon: 'fa-om' }], 15: [{ name: ' ', type: ' ', holiday: true, icon: 'fa-landmark' }] },
            3: { 15: [{ name: ' ', type: '', holiday: false, icon: 'fa-seedling' }] },
            4: { 15: [{ name: ' ', type: '', holiday: false, icon: 'fa-dragon' }] },
            5: { 3: [{ name: ' ', type: ' ', holiday: true, icon: 'fa-pray' }], 7: [{ name: '', type: ' ', holiday: true, icon: 'fa-cow' }], 18: [{ name: ' ', type: ' ', holiday: true, icon: 'fa-om' }], 27: [{ name: '', type: ' ', holiday: true, icon: 'fa-star' }] },
            6: { 1: [{ name: '', type: '', holiday: false, icon: 'fa-seedling' }], 7: [{ name: '', type: ' ', holiday: true, icon: 'fa-leaf' }], 8: [{ name: '', type: ' ', holiday: true, icon: 'fa-om' }], 9: [{ name: '', type: ' ', holiday: true, icon: 'fa-om' }], 10: [{ name: ' ', type: ' ', holiday: true, icon: 'fa-crown' }] },
            7: { 14: [{ name: ' ', type: ' ', holiday: true, icon: 'fa-coins' }], 15: [{ name: ' ', type: ' ', holiday: true, icon: 'fa-mountain' }], 16: [{ name: '', type: ' ', holiday: true, icon: 'fa-heart' }], 18: [{ name: ' ', type: ' ', holiday: true, icon: 'fa-sun' }] },
            9: { 1: [{ name: ' ', type: ' ', holiday: true, icon: 'fa-mountain-sun' }], 25: [{ name: '', type: ' ', holiday: true, icon: 'fa-tree' }] },
            10: { 1: [{ name: ' ', type: ' ', holiday: true, icon: 'fa-sun' }], 11: [{ name: ' ', type: ' ', holiday: true, icon: 'fa-crown' }], 22: [{ name: ' ', type: ' ', holiday: true, icon: 'fa-flag' }], 28: [{ name: '  ', type: '', holiday: false, icon: 'fa-shield' }, { name: '    ', type: '', holiday: false, icon: 'fa-venus' }] },
            11: { 1: [{ name: ' ', type: '', holiday: false, icon: 'fa-water' }, { name: '  ', type: '', holiday: false, icon: 'fa-pray' }], 2: [{ name: '  ', type: '', holiday: false, icon: 'fa-moon' }, { name: ' ', type: '', holiday: false, icon: 'fa-heart' }], 7: [{ name: ' ', type: ' ', holiday: true, icon: 'fa-landmark' }], 15: [{ name: '', type: ' ', holiday: true, icon: 'fa-palette' }], 26: [{ name: '', type: ' ', holiday: true, icon: 'fa-om' }] },
            12: { 8: [{ name: ' ', type: '', holiday: false, icon: 'fa-venus' }] }
        };

        // ============================================
        // Utility Functions
        // ============================================
        
        function toNepali(num) {
            return String(num).split('').map(d => NEP_DIGITS[parseInt(d)] || d).join('');
        }

        function getDaysInMonth(year, month) {
            return BS_DATA[year] ? BS_DATA[year][month - 1] : 30;
        }

        function getTotalDays(year) {
            return BS_DATA[year] ? BS_DATA[year].reduce((a, b) => a + b, 0) : 365;
        }

        function bsToAd(y, m, d) {
            let total = 0;
            for (let i = BS_REF.year; i < y; i++) total += getTotalDays(i);
            for (let i = 1; i < m; i++) total += getDaysInMonth(y, i);
            total += d - 1;
            const ad = new Date(AD_REF);
            ad.setDate(ad.getDate() + total);
            return { year: ad.getFullYear(), month: ad.getMonth() + 1, day: ad.getDate(), dow: ad.getDay() };
        }

        function adToBs(y, m, d) {
            const target = new Date(y, m - 1, d);
            let total = Math.floor((target - AD_REF) / (1000 * 60 * 60 * 24));
            let bsY = BS_REF.year, bsM = BS_REF.month, bsD = BS_REF.day;
            while (total > 0) {
                const dim = getDaysInMonth(bsY, bsM);
                const rem = dim - bsD;
                if (total <= rem) { bsD += total; total = 0; }
                else { total -= (rem + 1); bsM++; bsD = 1; if (bsM > 12) { bsM = 1; bsY++; } }
            }
            return { year: bsY, month: bsM, day: bsD };
        }

        function getToday() {
            const t = new Date();
            return adToBs(t.getFullYear(), t.getMonth() + 1, t.getDate());
        }

        function getFirstDay(y, m) {
            return bsToAd(y, m, 1).dow;
        }

        function calculateTithi(year, month, day) {
            const ad = bsToAd(year, month, day);
            const date = new Date(ad.year, ad.month - 1, ad.day);
            const refNewMoon = new Date(2024, 0, 11);
            const daysSinceNewMoon = Math.floor((date - refNewMoon) / (1000 * 60 * 60 * 24));
            const lunarDay = ((daysSinceNewMoon % 29.53) + 29.53) % 29.53;
            const tithiIndex = Math.floor(lunarDay / 2) % 15;
            const paksha = lunarDay < 15 ? '' : '';
            return { tithi: TITHIS[tithiIndex], paksha };
        }

        function getEvents(month, day) {
            return (NEPAL_EVENTS[month] && NEPAL_EVENTS[month][day]) ? NEPAL_EVENTS[month][day] : [];
        }

        // ============================================
        // State
        // ============================================
        
        const today = getToday();
        let currentYear = today.year;
        let currentMonth = today.month;
        let selectedDate = null;
        let yearRangeStart = Math.floor(currentYear / 12) * 12;

        // PWA Install
        let deferredPrompt = null;

        // ============================================
        // Render Functions
        // ============================================
        
        function renderWeekdays() {
            const el = document.getElementById('weekdays');
            el.innerHTML = NEP_DAYS.map((d, i) => 
                `<div class="weekday ${i === 0 ? 'sunday' : ''} ${i === 6 ? 'saturday' : ''}">
                    <span class="weekday-nep">${d}</span>
                    <span class="weekday-eng">${ENG_DAYS[i]}</span>
                </div>`
            ).join('');
        }

        function renderCalendar() {
            document.getElementById('monthBtn').textContent = NEP_MONTHS[currentMonth - 1];
            document.getElementById('yearBtn').textContent = toNepali(currentYear);
            document.getElementById('titleEnglish').textContent = `${ENG_MONTHS[currentMonth - 1]} ${currentYear}`;

            const daysEl = document.getElementById('calendarDays');
            const daysInMonth = getDaysInMonth(currentYear, currentMonth);
            const firstDay = getFirstDay(currentYear, currentMonth);
            const t = getToday();

            let html = '';
            for (let i = 0; i < firstDay; i++) html += '<div class="day empty"></div>';

            for (let d = 1; d <= daysInMonth; d++) {
                const ad = bsToAd(currentYear, currentMonth, d);
                const dow = (firstDay + d - 1) % 7;
                const tithiInfo = calculateTithi(currentYear, currentMonth, d);
                const events = getEvents(currentMonth, d);
                const hasHoliday = events.some(e => e.holiday);

                let cls = 'day';
                if (dow === 0) cls += ' sunday';
                if (dow === 6) cls += ' saturday';
                if (currentYear === t.year && currentMonth === t.month && d === t.day) cls += ' today';
                if (selectedDate && selectedDate.year === currentYear && selectedDate.month === currentMonth && selectedDate.day === d) cls += ' selected';
                if (events.length > 0) cls += ' has-event';
                if (hasHoliday) cls += ' holiday';

                html += `
                    <div class="${cls}" onclick="selectDate(${currentYear}, ${currentMonth}, ${d})">
                        <span class="day-num">${toNepali(d)}</span>
                        <span class="day-eng">${ad.day}</span>
                        <span class="day-tithi">${tithiInfo.tithi}</span>
                    </div>
                `;
            }

            daysEl.innerHTML = html;
            renderEventsStrip();
        }

        function renderEventsStrip() {
            const row = document.getElementById('eventsRow');
            const monthEvents = NEPAL_EVENTS[currentMonth] || {};
            const days = Object.keys(monthEvents).map(Number).sort((a, b) => a - b);
            
            if (days.length === 0) {
                row.innerHTML = '<div class="no-events">    </div>';
                return;
            }

            let html = '';
            for (const day of days) {
                for (const event of monthEvents[day]) {
                    html += `
                        <div class="event-chip ${event.holiday ? 'holiday' : ''}" onclick="selectDate(${currentYear}, ${currentMonth}, ${day})">
                            <span class="event-chip-date">${toNepali(day)}</span>
                            <span>${event.name}</span>
                        </div>
                    `;
                }
            }
            row.innerHTML = html;
        }

        function renderTodaySidebar() {
            const t = getToday();
            const ad = bsToAd(t.year, t.month, t.day);
            const tithiInfo = calculateTithi(t.year, t.month, t.day);
            const events = getEvents(t.month, t.day);

            document.getElementById('todayDateBig').textContent = toNepali(t.day);
            document.getElementById('todayDayName').textContent = NEP_DAYS_FULL[ad.dow];
            document.getElementById('todayMonthYear').textContent = `${NEP_MONTHS[t.month - 1]}, ${toNepali(t.year)}`;
            document.getElementById('todayEnglishDate').textContent = `${ENG_DAYS_FULL[ad.dow]}, ${ENG_MONTHS_FULL[ad.month - 1]} ${ad.day}, ${ad.year}`;
            document.getElementById('todayTithi').textContent = tithiInfo.tithi;

            if (events.length > 0) {
                document.getElementById('todayEventsBox').style.display = 'block';
                document.getElementById('todayEventsList').textContent = events.map(e => e.name).join(' / ');
            } else {
                document.getElementById('todayEventsBox').style.display = 'none';
            }

            // Update time every second
            updateTime();
            setInterval(updateTime, 1000);

            // Fetch weather and sun data
            fetchWeatherData();
            calculateSunTimes();
        }

        function updateTime() {
            const now = new Date();
            let hours = now.getHours();
            let minutes = now.getMinutes();
            let seconds = now.getSeconds();
            const ampm = hours >= 12 ? 'PM' : 'AM';
            hours = hours % 12;
            hours = hours ? hours : 12;
            
            const timeStr = `${toNepali(hours)}:${toNepali(String(minutes).padStart(2, '0'))}:${toNepali(String(seconds).padStart(2, '0'))} ${ampm}`;
            document.getElementById('todayTime').textContent = timeStr;
        }

        function calculateSunTimes() {
            // Kathmandu coordinates
            const lat = 27.7172;
            const lng = 85.3240;
            const now = new Date();
            
            // Simple sunrise/sunset calculation for Kathmandu based on season
            const dayOfYear = Math.floor((now - new Date(now.getFullYear(), 0, 0)) / (1000 * 60 * 60 * 24));
            
            let sunriseHour, sunriseMin, sunsetHour, sunsetMin;
            
            if (dayOfYear >= 1 && dayOfYear <= 80) {
                sunriseHour = 6; sunriseMin = 44;
                sunsetHour = 17; sunsetMin = 51;
            } else if (dayOfYear >= 81 && dayOfYear <= 172) {
                sunriseHour = 5; sunriseMin = 15;
                sunsetHour = 18; sunsetMin = 45;
            } else if (dayOfYear >= 173 && dayOfYear <= 266) {
                sunriseHour = 5; sunriseMin = 30;
                sunsetHour = 18; sunsetMin = 30;
            } else {
                sunriseHour = 6; sunriseMin = 15;
                sunsetHour = 17; sunsetMin = 15;
            }
            
            document.getElementById('sunriseTime').textContent = `${toNepali(sunriseHour)}:${toNepali(String(sunriseMin).padStart(2, '0'))} `;
            document.getElementById('sunsetTime').textContent = `${toNepali(sunsetHour)}:${toNepali(String(sunsetMin).padStart(2, '0'))} `;
        }

        async function fetchWeatherData() {
            try {
                const response = await fetch('https://api.open-meteo.com/v1/forecast?latitude=27.7172&longitude=85.3240&current=temperature_2m,weather_code&timezone=Asia/Kathmandu');
                const data = await response.json();
                
                const temp = Math.round(data.current.temperature_2m * 10) / 10;
                const weatherCode = data.current.weather_code;
                
                document.getElementById('weatherTemp').textContent = `${temp}C`;
                
                const weatherInfo = getWeatherInfo(weatherCode);
                document.getElementById('weatherCondition').textContent = weatherInfo.condition;
                document.getElementById('weatherIcon').innerHTML = `<i class="fas ${weatherInfo.icon}"></i>`;
                
            } catch (error) {
                console.log('Weather fetch error:', error);
                document.getElementById('weatherCondition').textContent = 'N/A';
            }
        }

        function getWeatherInfo(code) {
            const weatherCodes = {
                0: { condition: 'Clear', icon: 'fa-sun' },
                1: { condition: 'Mainly Clear', icon: 'fa-sun' },
                2: { condition: 'Partly Cloudy', icon: 'fa-cloud-sun' },
                3: { condition: 'Overcast', icon: 'fa-cloud' },
                45: { condition: 'Foggy', icon: 'fa-smog' },
                48: { condition: 'Fog', icon: 'fa-smog' },
                51: { condition: 'Light Drizzle', icon: 'fa-cloud-rain' },
                53: { condition: 'Drizzle', icon: 'fa-cloud-rain' },
                55: { condition: 'Dense Drizzle', icon: 'fa-cloud-rain' },
                61: { condition: 'Light Rain', icon: 'fa-cloud-showers-heavy' },
                63: { condition: 'Rain', icon: 'fa-cloud-showers-heavy' },
                65: { condition: 'Heavy Rain', icon: 'fa-cloud-showers-heavy' },
                71: { condition: 'Light Snow', icon: 'fa-snowflake' },
                73: { condition: 'Snow', icon: 'fa-snowflake' },
                75: { condition: 'Heavy Snow', icon: 'fa-snowflake' },
                80: { condition: 'Rain Showers', icon: 'fa-cloud-showers-heavy' },
                95: { condition: 'Thunderstorm', icon: 'fa-bolt' }
            };
            return weatherCodes[code] || { condition: 'Clear', icon: 'fa-sun' };
        }

        function renderUpcomingEvents() {
            const t = getToday();
            const upcomingList = document.getElementById('upcomingList');
            let allEvents = [];

            for (let m = t.month; m <= 12; m++) {
                const monthEvents = NEPAL_EVENTS[m] || {};
                for (const day in monthEvents) {
                    const dayNum = parseInt(day);
                    if (m === t.month && dayNum < t.day) continue;
                    
                    for (const event of monthEvents[day]) {
                        allEvents.push({
                            year: t.year,
                            month: m,
                            day: dayNum,
                            ...event
                        });
                    }
                }
            }

            allEvents.sort((a, b) => {
                if (a.month !== b.month) return a.month - b.month;
                return a.day - b.day;
            });

            allEvents = allEvents.slice(0, 15);

            if (allEvents.length === 0) {
                upcomingList.innerHTML = `
                    <div class="upcoming-no-events">
                        <i data-lucide="calendar-x"></i>
                        <p>   </p>
                    </div>
                `;
                lucide.createIcons();
                return;
            }

            let html = '';
            for (const event of allEvents) {
                const ad = bsToAd(event.year, event.month, event.day);
                const tithiInfo = calculateTithi(event.year, event.month, event.day);
                const isToday = (event.year === t.year && event.month === t.month && event.day === t.day);
                
                const todayAd = bsToAd(t.year, t.month, t.day);
                const todayDate = new Date(todayAd.year, todayAd.month - 1, todayAd.day);
                const eventDate = new Date(ad.year, ad.month - 1, ad.day);
                const daysLeft = Math.ceil((eventDate - todayDate) / (1000 * 60 * 60 * 24));

                let badgeText = '';
                if (isToday) {
                    badgeText = 'Today';
                } else if (daysLeft === 1) {
                    badgeText = '1 day left';
                } else {
                    badgeText = `${daysLeft} days left`;
                }

                html += `
                    <div class="upcoming-item ${isToday ? 'today-item' : ''}" onclick="selectDate(${event.year}, ${event.month}, ${event.day})">
                        <div class="upcoming-date-box">
                            <div class="upcoming-date-day">${NEP_DAYS_SHORT[ad.dow]}</div>
                            <div class="upcoming-date-num">${toNepali(event.day)}</div>
                            <div class="upcoming-date-tithi">${tithiInfo.tithi}</div>
                        </div>
                        <div class="upcoming-info">
                            <div class="upcoming-badge ${isToday ? 'today-badge' : ''}">
                                <i data-lucide="${isToday ? 'calendar-check' : 'clock'}"></i>
                                ${badgeText}
                            </div>
                            <div class="upcoming-event-name">${event.name}</div>
                        </div>
                    </div>
                `;
            }

            upcomingList.innerHTML = html;
            lucide.createIcons();
        }

        function renderYearPicker() {
            const grid = document.getElementById('yearGrid');
            const t = getToday();
            const end = yearRangeStart + 11;

            document.getElementById('yearRange').textContent = `${toNepali(yearRangeStart)} - ${toNepali(end)}`;

            let html = '';
            for (let y = yearRangeStart; y <= end; y++) {
                let cls = 'picker-item';
                if (y === currentYear) cls += ' selected';
                if (y === t.year) cls += ' current';
                if (y < 2070 || y > 2099) cls += ' disabled';

                html += `
                    <div class="${cls}" onclick="selectYear(${y})">
                        <span class="picker-item-nep">${toNepali(y)}</span>
                        <span class="picker-item-eng">${y}</span>
                    </div>
                `;
            }
            grid.innerHTML = html;
        }

        function renderMonthPicker() {
            const grid = document.getElementById('monthGrid');
            const t = getToday();

            let html = '';
            for (let m = 1; m <= 12; m++) {
                let cls = 'picker-item';
                if (m === currentMonth) cls += ' selected';
                if (m === t.month && currentYear === t.year) cls += ' current';

                html += `
                    <div class="${cls}" onclick="selectMonth(${m})">
                        <span class="picker-item-nep">${NEP_MONTHS[m - 1]}</span>
                        <span class="picker-item-eng">${ENG_MONTHS[m - 1]}</span>
                    </div>
                `;
            }
            grid.innerHTML = html;
        }

        // ============================================
        // Actions
        // ============================================
        
        function selectDate(year, month, day) {
            selectedDate = { year, month, day };
            renderCalendar();
            openModal(year, month, day);
        }

        function selectYear(year) {
            if (year < 2070 || year > 2099) return;
            currentYear = year;
            closeYearPicker();
            renderCalendar();
        }

        function selectMonth(month) {
            currentMonth = month;
            closeMonthPicker();
            renderCalendar();
        }

        function prevMonth() {
            currentMonth--;
            if (currentMonth < 1) { currentMonth = 12; currentYear--; }
            if (currentYear < 2070) { currentYear = 2070; currentMonth = 1; }
            renderCalendar();
        }

        function nextMonth() {
            currentMonth++;
            if (currentMonth > 12) { currentMonth = 1; currentYear++; }
            if (currentYear > 2099) { currentYear = 2099; currentMonth = 12; }
            renderCalendar();
        }

        function openYearPicker() {
            yearRangeStart = Math.floor(currentYear / 12) * 12;
            renderYearPicker();
            document.getElementById('yearPicker').classList.add('active');
        }

        function closeYearPicker() {
            document.getElementById('yearPicker').classList.remove('active');
        }

        function openMonthPicker() {
            renderMonthPicker();
            document.getElementById('monthPicker').classList.add('active');
        }

        function closeMonthPicker() {
            document.getElementById('monthPicker').classList.remove('active');
        }

        function openModal(year, month, day) {
            const ad = bsToAd(year, month, day);
            const tithiInfo = calculateTithi(year, month, day);
            const events = getEvents(month, day);

            document.getElementById('modalDay').textContent = toNepali(day);
            document.getElementById('modalMonthYear').textContent = `${NEP_MONTHS[month - 1]} ${toNepali(year)}`;
            document.getElementById('modalDayName').textContent = NEP_DAYS_FULL[ad.dow];
            document.getElementById('modalBS').textContent = `${toNepali(year)}/${toNepali(month)}/${toNepali(day)}`;
            document.getElementById('modalAD').textContent = `${ad.year}/${ad.month}/${ad.day}`;
            document.getElementById('modalTithi').textContent = tithiInfo.tithi;
            document.getElementById('modalPaksha').textContent = tithiInfo.paksha;

            const eventsEl = document.getElementById('modalEvents');
            if (events.length > 0) {
                eventsEl.innerHTML = events.map(e => `
                    <div class="modal-event ${e.holiday ? 'holiday' : ''}">
                        <div class="modal-event-icon"><i class="fas ${e.icon}"></i></div>
                        <div>
                            <div class="modal-event-name">${e.name}</div>
                            <div class="modal-event-type">${e.type}</div>
                        </div>
                    </div>
                `).join('');
            } else {
                eventsEl.innerHTML = `
                    <div class="modal-no-events">
                        <i data-lucide="calendar-x"></i>
                        <p>  </p>
                    </div>
                `;
                lucide.createIcons();
            }

            document.getElementById('modalOverlay').classList.add('active');
        }

        function closeModal() {
            document.getElementById('modalOverlay').classList.remove('active');
        }

        function toggleMobileMenu() {
            document.getElementById('mobileMenu').classList.toggle('active');
        }

        // PWA Install
        async function installPWA() {
            const installPopup = document.getElementById('installPopup');
            
            if (deferredPrompt) {
                deferredPrompt.prompt();
                const { outcome } = await deferredPrompt.userChoice;
                console.log(`User response: ${outcome}`);
                if (outcome === 'accepted') {
                    installPopup.classList.add('hidden');
                }
                deferredPrompt = null;
            } else {
                const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent);
                const isAndroid = /Android/.test(navigator.userAgent);
                
                let message = '';
                if (isIOS) {
                    message = 'iOS  Install :\n1. Safari  Share  \n2. "Add to Home Screen" ';
                } else if (isAndroid) {
                    message = 'Android  Install :\n1. Browser menu () \n2. "Add to Home Screen"  "Install App" ';
                } else {
                    message = 'Install :\n1. Browser menu \n2. "Install"  "Add to Home Screen" ';
                }
                alert(message);
            }
        }

        function checkInstallability() {
            const installPopup = document.getElementById('installPopup');
            
            if (window.matchMedia('(display-mode: standalone)').matches) {
                installPopup.classList.add('hidden');
                return;
            }
            
            if (window.navigator.standalone === true) {
                installPopup.classList.add('hidden');
                return;
            }
            
            installPopup.classList.remove('hidden');
        }

        // ============================================
        // Event Listeners
        // ============================================
        
        document.getElementById('prevMonth').addEventListener('click', prevMonth);
        document.getElementById('nextMonth').addEventListener('click', nextMonth);
        document.getElementById('yearBtn').addEventListener('click', openYearPicker);
        document.getElementById('monthBtn').addEventListener('click', openMonthPicker);
        document.getElementById('yearPickerClose').addEventListener('click', closeYearPicker);
        document.getElementById('monthPickerClose').addEventListener('click', closeMonthPicker);
        document.getElementById('modalClose').addEventListener('click', closeModal);
        document.getElementById('mobileToggle').addEventListener('click', toggleMobileMenu);
        document.getElementById('installBtn').addEventListener('click', installPWA);

        document.getElementById('yearPicker').addEventListener('click', (e) => { if (e.target.id === 'yearPicker') closeYearPicker(); });
        document.getElementById('monthPicker').addEventListener('click', (e) => { if (e.target.id === 'monthPicker') closeMonthPicker(); });
        document.getElementById('modalOverlay').addEventListener('click', (e) => { if (e.target.id === 'modalOverlay') closeModal(); });

        document.getElementById('yearPrev').addEventListener('click', () => {
            yearRangeStart = Math.max(yearRangeStart - 12, 2064);
            renderYearPicker();
        });

        document.getElementById('yearNext').addEventListener('click', () => {
            yearRangeStart = Math.min(yearRangeStart + 12, 2088);
            renderYearPicker();
        });

        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeModal();
                closeYearPicker();
                closeMonthPicker();
            }
            if (e.key === 'ArrowLeft') prevMonth();
            if (e.key === 'ArrowRight') nextMonth();
        });

        // PWA Install Event
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            document.getElementById('installPopup').classList.remove('hidden');
        });

        window.addEventListener('appinstalled', () => {
            deferredPrompt = null;
            document.getElementById('installPopup').classList.add('hidden');
        });

        // ============================================
        // Initialize
        // ============================================
        
        function init() {
            lucide.createIcons();
            renderWeekdays();
            renderCalendar();
            renderTodaySidebar();
            renderUpcomingEvents();
            checkInstallability();
        }

        document.addEventListener('DOMContentLoaded', init);
    </script>
    <script src="Base/ConsoleBlock.js"></script>
</body>
</html>